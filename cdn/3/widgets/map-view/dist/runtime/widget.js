System.register(["jimu-core","jimu-ui","jimu-arcgis"],(function(e,t){var r={},o={},n={};return{setters:[function(e){r.DataSourceComponent=e.DataSourceComponent,r.React=e.React},function(e){o.Alert=e.Alert,o.Button=e.Button,o.Loading=e.Loading,o.LoadingType=e.LoadingType,o.Select=e.Select,o.TextArea=e.TextArea,o.TextInput=e.TextInput},function(e){n.MapViewManager=e.MapViewManager}],execute:function(){e((()=>{var e={781:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var o=r(601),n=r.n(o),i=r(314),a=r.n(i)()(n());a.push([e.id,'.map-widget{padding:0;background-color:#fff;border-radius:10px;box-shadow:0 1px 3px rgba(0, 0, 0, 0.1);display:flex;flex-direction:column;height:100vh;position:relative;overflow:hidden}.map-container{width:100%;height:100%;background-color:#f5f8fa;border-radius:10px;box-shadow:0 1px 3px rgba(0, 0, 0, 0.1);transition:all .3s ease}.incident-form{position:absolute;bottom:0;width:100%;background-color:white;border-top-left-radius:1rem;border-top-right-radius:1rem;padding:1rem;box-shadow:0 -2px 10px rgba(0, 0, 0, 0.15);z-index:20;height:30vh;max-height:45vh;min-height:15vh;overflow-y:auto;resize:vertical;transition:opacity .3s ease,transform .3s ease;opacity:0;transform:translateY(100%)}.map-widget.incident-mode .incident-form{opacity:1;transform:translateY(0)}.incident-form.submitted{opacity:0;transform:translateY(100%);pointer-events:none}.text-input{margin-bottom:10px;width:100%}.incident-mode-btn{position:absolute;top:20px;left:65px;z-index:10;background-color:#1da1f2;color:white;border:none;padding:10px;border-radius:8px;cursor:pointer;box-shadow:0 1px 3px rgba(0, 0, 0, 0.2);transition:background-color .3s ease}.incident-mode-btn:hover{background-color:#09c}.form-coords{margin-top:.5rem;font-size:.9rem;color:#555}.incident-form h4{font-size:1.5rem;font-weight:bold;color:#1da1f2;margin-bottom:1rem}.incident-form .text-input{padding:8px;border:1px solid #e1e8ed;border-radius:8px;background-color:#f5f8fa;font-size:14px}.incident-form select.text-input{height:38px}.incident-form .text-red-600{font-size:14px;color:#e0245e}.incident-card{background-color:#fff;border-radius:1rem;box-shadow:0 2px 10px rgba(0, 0, 0, 0.1);padding:1.25rem;margin-bottom:1rem;transition:all .3s ease}.incident-card:hover{box-shadow:0 4px 15px rgba(0, 0, 0, 0.15)}.dropdown-search-filter{position:absolute;top:20px;right:20px;z-index:20;background-color:white;border-radius:8px;padding:10px;box-shadow:0 1px 3px rgba(0, 0, 0, 0.2);display:flex;flex-direction:column;width:30%;user-select:none;max-width:400px;min-width:200px}.search-input{margin-bottom:10px;padding:8px;border:1px solid #e1e8ed;border-radius:8px;background-color:#f5f8fa;font-size:14px}.dropdown-search-filter .jimu-dropdown{padding:8px;border:1px solid #e1e8ed;border-radius:8px;background-color:#f5f8fa;font-size:14px}.dropdown-search-filter select{height:38px;margin-bottom:10px}.dropdown-drag-handle{cursor:move;font-size:1rem;font-weight:bold;padding-bottom:6px;border-bottom:1px solid #eee;margin-bottom:10px}@media(max-width: 768px){.dropdown-search-filter{width:50%;min-width:250px}}@media(max-width: 480px){.dropdown-search-filter{width:80%;min-width:280px}}@media(max-width: 600px){.custom-dropdown{width:100%;max-width:none;box-sizing:border-box}}.pulse-marker{width:20px;height:20px;background-color:#1da1f2;border-radius:50%;position:relative;transform:translate(-50%, -50%)}.pulse-marker::after{content:"";position:absolute;top:50%;left:50%;width:100%;height:100%;background-color:#1da1f2;border-radius:50%;transform:translate(-50%, -50%);animation:pulse 1.5s infinite;opacity:.5}@keyframes pulse{0%{transform:translate(-50%, -50%) scale(1);opacity:.5}100%{transform:translate(-50%, -50%) scale(2.5);opacity:0}}.locate-button{position:absolute;top:90px;left:20px;z-index:1000}',""]);const s=a},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",o=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),o&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),o&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,o,n,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);o&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),n&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=n):l[4]="".concat(n)),t.push(l))}},t}},601:e=>{"use strict";e.exports=function(e){return e[1]}},72:e=>{"use strict";var t=[];function r(e){for(var r=-1,o=0;o<t.length;o++)if(t[o].identifier===e){r=o;break}return r}function o(e,o){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],d=o.base?c[0]+o.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var m=r(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==m)t[m].references++,t[m].updater(p);else{var h=n(p,o);o.byIndex=s,t.splice(s,0,{identifier:u,updater:h,references:1})}a.push(u)}return a}function n(e,t){var r=t.domAPI(t);r.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,n){var i=o(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=r(i[a]);t[s].references--}for(var c=o(e,n),d=0;d<i.length;d++){var l=r(i[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},659:e=>{"use strict";var t={};e.exports=function(e,r){var o=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var o="";r.supports&&(o+="@supports (".concat(r.supports,") {")),r.media&&(o+="@media ".concat(r.media," {"));var n=void 0!==r.layer;n&&(o+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),o+=r.css,n&&(o+="}"),r.media&&(o+="}"),r.supports&&(o+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},686:e=>{"use strict";e.exports=n},244:e=>{"use strict";e.exports=r},321:e=>{"use strict";e.exports=o}},t={};function i(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={id:r,exports:{}};return e[r](n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="",i.nc=void 0;var a={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(a),i.d(a,{__set_webpack_public_path__:()=>P,default:()=>j});var e=i(244),t=i(321),r=i(686);const o={Promise:"undefined"!=typeof window?window.Promise:void 0};var n="4.25",s="next";function c(e){if(e.toLowerCase()===s)return s;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function d(e){return void 0===e&&(e=n),"https://js.arcgis.com/".concat(e,"/")}function l(e){return!e||c(e)?function(e){void 0===e&&(e=n);var t=d(e),r=c(e);if(r!==s&&3===r.major){var o=r.minor<=10?"js/":"";return"".concat(t).concat(o,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}(e):e}function u(e,t){var r=l(e),o=function(e){return document.querySelector('link[href*="'.concat(e,'"]'))}(r);return o||function(e,t){if(t){var r=document.querySelector(t);r.parentNode.insertBefore(e,r)}else document.head.appendChild(e)}(o=function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}(r),t),o}var m={};function p(e,t,r){var o;r&&(o=function(e,t){var r=function(o){t(o.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",r,!1)};return e.addEventListener("error",r,!1),r}(e,r));var n=function(){t(e),e.removeEventListener("load",n,!1),o&&e.removeEventListener("error",o,!1)};e.addEventListener("load",n,!1)}function h(){return document.querySelector("script[data-esri-loader]")}function f(){var e=window.require;return e&&e.on}function g(e){void 0===e&&(e={});var t={};[m,e].forEach((function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}));var r=t.version,n=t.url||d(r);return new o.Promise((function(e,o){var i=h();if(i){var a=i.getAttribute("src");a!==n?o(new Error("The ArcGIS API for JavaScript is already loaded (".concat(a,")."))):f()?e(i):p(i,e,o)}else if(f())o(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=t.css;if(s)u(!0===s?r:s,t.insertCssBefore);i=function(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}(n),p(i,(function(){i.setAttribute("data-esri-loader","loaded"),e(i)}),o),document.body.appendChild(i)}}))}function v(e){return new o.Promise((function(t,r){var o=window.require.on("error",r);window.require(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];o.remove(),t(e)}))}))}function w(e,t){if(void 0===t&&(t={}),f())return v(e);var r=h(),o=r&&r.getAttribute("src");return!t.url&&o&&(t.url=o),g(t).then((function(){return v(e)}))}var b=i(72),x=i.n(b),y=i(825),E=i.n(y),R=i(659),S=i.n(R),C=i(56),T=i.n(C),D=i(540),A=i.n(D),I=i(113),L=i.n(I),F=i(781),k={};k.styleTagTransform=L(),k.setAttributes=T(),k.insert=S().bind(null,"head"),k.domAPI=E(),k.insertStyleElement=A();x()(F.A,k);F.A&&F.A.locals&&F.A.locals;var M=function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};class O extends e.React.PureComponent{constructor(){super(...arguments),this.mapContainer=e.React.createRef(),this.dropdownRef=e.React.createRef(),this.LegendComponent=e.React.createRef(),this.isDragging=!1,this.offset={x:0,y:0},this.mvManager=r.MapViewManager.getInstance(),this.state={incidentMode:!1,coords:null,formData:{title:"",description:"",category:"",image:null},formErrors:{},loading:!1,alert:"",showAlert:!1,formSubmitted:!1,featureRecords:[],allFeatureRecords:[],selectedFeatureId:"",searchText:"",showlegend:!1},this.onDsCreated=e=>M(this,void 0,void 0,(function*(){if(!e)return;const[t,r]=yield w(["esri/views/MapView","esri/WebMap"]);e.map||new r({portalItem:{id:e.itemId}}),this.mapContainer.current;if(!this.mvManager.getJimuMapViewById(this.props.id)){const r={map:e.map,container:this.mapContainer.current};this.mvManager.createJimuMapView({mapWidgetId:this.props.id,view:new t(r),dataSourceId:e.id,isActive:!0,mapViewManager:this.mvManager}).then((e=>{this.mapView=e.view,this.mapView.on("click",this.handleMapClick),this.mapView.on("immediate-click",this.handleMapClick),this.mapView.on("pointer-down",(e=>{"touch"===e.pointerType&&this.handleMapClick(e)})),this.loadFeatureRecords()}))}})),this.loadLegend=()=>M(this,void 0,void 0,(function*(){if(!this.mapView||!this.LegendComponent.current)return;const[e]=yield w(["esri/widgets/Legend"]);new e({view:this.mapView,container:this.LegendComponent.current})})),this.makeDropdownDraggable=()=>{const e=this.dropdownRef.current;if(!e)return;const t=e.querySelector(".dropdown-drag-handle");if(!t)return;const r=t=>{this.isDragging&&(e.style.left=t.clientX-this.offset.x+"px",e.style.top=t.clientY-this.offset.y+"px")},o=()=>{this.isDragging=!1,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",o)};t.addEventListener("mousedown",(t=>{t.preventDefault(),this.isDragging=!0,this.offset={x:t.clientX-e.getBoundingClientRect().left,y:t.clientY-e.getBoundingClientRect().top},document.addEventListener("mousemove",r),document.addEventListener("mouseup",o)}))},this.zoomToFeature=e=>{const t=this.state.allFeatureRecords.find((t=>t.attributes.OBJECTID===parseInt(e)));t&&this.mapView&&this.mapView.goTo({target:t.geometry,zoom:64})},this.handleLegendToggle=()=>{this.setState((e=>({showLegend:!e.showLegend})))},this.zoomToUserLocation=()=>M(this,void 0,void 0,(function*(){try{const[e,t,r]=yield w(["esri/Graphic","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol"]);navigator.geolocation.getCurrentPosition((o=>M(this,void 0,void 0,(function*(){const{latitude:n,longitude:i}=o.coords,a=new t({latitude:n,longitude:i,spatialReference:{wkid:4326}});yield this.mapView.goTo({target:a,zoom:16});const s=(t,o)=>{const n=new r({color:[29,155,240,.3],size:t,outline:{color:[29,155,240,.8],width:1.5},style:"circle"}),i=new e({geometry:a,symbol:n});this.mapView.graphics.add(i);let s=Date.now();const c=()=>{const e=(Date.now()-s)/o,r=1-Math.pow(1-e,3);e>=1?this.mapView.graphics.remove(i):(n.size=t+1e3*r,n.color=[29,155,240,.3*(1-r)],i.symbol=n,requestAnimationFrame(c))};c()},c=new e({geometry:a,symbol:new r({color:[29,155,240,1],size:10,outline:{color:[255,255,255,1],width:2}})});this.mapView.graphics.add(c);for(let e=0;e<4;e++)setTimeout((()=>s(10,2e3)),600*e);setTimeout((()=>{this.mapView.graphics.remove(c)}),8e3)}))),(e=>{console.error("Geolocation error:",e),alert("Unable to fetch your location. Please allow location access.")}))}catch(e){console.error("Error loading location modules:",e)}})),this.loadFeatureRecords=()=>M(this,void 0,void 0,(function*(){try{const[e]=yield w(["esri/layers/FeatureLayer"]),t=new e({url:"https://services1.arcgis.com/KsnB2VOAvO5LjdB4/arcgis/rest/services/Incident_Reporting_Layer/FeatureServer/0"}),r=t.createQuery();r.returnGeometry=!0,r.outFields=["*"];const o=(yield t.queryFeatures(r)).features.sort(((e,t)=>{const r=new Date(e.attributes.DateAndTime);return new Date(t.attributes.DateAndTime).getTime()-r.getTime()}));this.setState({featureRecords:o,allFeatureRecords:o})}catch(e){console.error("Error loading feature records:",e)}})),this.filterIncidents=e=>{if(this.setState({searchText:e}),!e.trim())return void this.setState({featureRecords:this.state.allFeatureRecords});const t=this.state.allFeatureRecords.filter((t=>(t.attributes.Title||"").toLowerCase().includes(e.toLowerCase())||(t.attributes.Description||"").toLowerCase().includes(e.toLowerCase()))).sort(((e,t)=>new Date(t.attributes.DateAndTime).getTime()-new Date(e.attributes.DateAndTime).getTime()));this.setState({featureRecords:t,allFeatureRecords:t})},this.handleMapClick=e=>{if(!this.state.incidentMode)return;e.stopPropagation(),e.preventDefault();const t=e.mapPoint,r=this.state.formSubmitted;this.setState(Object.assign({coords:{latitude:t.latitude.toFixed(6),longitude:t.longitude.toFixed(6)}},r&&{formData:{title:"",description:"",category:"",image:null},formSubmitted:!1,formErrors:{}}))},this.handleIncidentModeToggle=()=>{this.setState({incidentMode:!this.state.incidentMode,coords:null,formErrors:{},alert:"",showAlert:!1,formSubmitted:!1})},this.handleFormChange=(e,t)=>{this.setState((r=>({formData:Object.assign(Object.assign({},r.formData),{[e]:t}),formErrors:Object.assign(Object.assign({},r.formErrors),{[e]:void 0})})))},this.handleImageChange=e=>{const t=e.target.files?e.target.files[0]:null;this.handleFormChange("image",t)},this.validateForm=()=>{const{title:e,description:t,category:r}=this.state.formData,o={};return e||(o.title="Title is required."),t||(o.description="Description is required."),r||(o.category="Category is required."),this.setState({formErrors:o}),0===Object.keys(o).length},this.handleSubmitForm=()=>M(this,void 0,void 0,(function*(){var e,t;const{coords:r,formData:o}=this.state;if(r&&this.validateForm()){this.setState({loading:!0});try{const n={f:"json",features:JSON.stringify([{attributes:{Title:o.title,Description:o.description,Category:o.category,DateAndTime:(new Date).toISOString()},geometry:{x:parseFloat(r.longitude),y:parseFloat(r.latitude),spatialReference:{wkid:4326}}}])},i=yield fetch("https://services1.arcgis.com/KsnB2VOAvO5LjdB4/arcgis/rest/services/Incident_Reporting_Layer/FeatureServer/0/addFeatures",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n)}),a=yield i.json(),s=null===(t=null===(e=null==a?void 0:a.addResults)||void 0===e?void 0:e[0])||void 0===t?void 0:t.objectId;if(!s)throw new Error("Failed to create feature");if(o.image){const e=new FormData;e.append("f","json"),e.append("file",o.image,o.image.name);const t=yield fetch(`https://services1.arcgis.com/KsnB2VOAvO5LjdB4/arcgis/rest/services/Incident_Reporting_Layer/FeatureServer/0/${s}/addAttachment`,{method:"POST",body:e}),r=yield t.json();r.success||console.warn("Attachment upload failed:",r)}const[c]=yield w(["esri/Graphic"]);new c({geometry:{type:"point",longitude:parseFloat(r.longitude),latitude:parseFloat(r.latitude)},symbol:{type:"simple-marker",color:"red",size:10}});this.setState({alert:"Incident reported successfully!",incidentMode:!1,coords:null,formData:{title:"",description:"",category:"",image:null},formErrors:{},loading:!1,showAlert:!0,formSubmitted:!0}),setTimeout((()=>{this.setState({showAlert:!1})}),4e3)}catch(e){console.error("Error submitting incident:",e),this.setState({alert:"Failed to submit incident.",loading:!1,showAlert:!0,formSubmitted:!0})}}})),this.renderForm=()=>{const{coords:r,formData:o,formErrors:n,formSubmitted:i}=this.state;return!r||i?null:e.React.createElement("div",{className:"incident-form "+(i?"submitted":"")},e.React.createElement("div",{className:"incident-card"},e.React.createElement("h4",null,"Report an Incident"),e.React.createElement(t.TextInput,{className:"text-input",value:o.title,onChange:e=>this.handleFormChange("title",e.target.value),placeholder:"Title"}),n.title&&e.React.createElement("div",{className:"text-red-600 text-sm"},n.title),e.React.createElement(t.TextArea,{className:"text-input",value:o.description,onChange:e=>this.handleFormChange("description",e.target.value),placeholder:"Description",rows:3}),n.description&&e.React.createElement("div",{className:"text-red-600 text-sm"},n.description),e.React.createElement(t.Select,{className:"text-input",value:o.category,onChange:e=>this.handleFormChange("category",e.target.value),placeholder:"Category"},e.React.createElement("option",{value:""},"--Select--"),e.React.createElement("option",{value:"Accident"},"Accident"),e.React.createElement("option",{value:"Animal"},"Animal"),e.React.createElement("option",{value:"Assault"},"Assault"),e.React.createElement("option",{value:"Breaking and Entering"},"Breaking and Entering"),e.React.createElement("option",{value:"Fire"},"Fire"),e.React.createElement("option",{value:"Fire Response"},"Fire Response"),e.React.createElement("option",{value:"Flood"},"Flood"),e.React.createElement("option",{value:"Hate Crimes"},"Hate Crimes"),e.React.createElement("option",{value:"Homicide"},"Homicide"),e.React.createElement("option",{value:"Police Activity"},"Police Activity"),e.React.createElement("option",{value:"Power Outage"},"Power Outage"),e.React.createElement("option",{value:"Public Safety Alert"},"Public Safety Alert"),e.React.createElement("option",{value:"Shooting and Firearm Discharge"},"Shooting and Firearm Discharge"),e.React.createElement("option",{value:"Suspicious Activity"},"Suspicious Activity"),e.React.createElement("option",{value:"Traffic"},"Traffic"),e.React.createElement("option",{value:"Theft"},"Theft"),e.React.createElement("option",{value:"Vandalism"},"Vandalism"),e.React.createElement("option",{value:"Weather/Environment"},"Weather/Environment")),n.category&&e.React.createElement("div",{className:"text-red-600 text-sm"},n.category),e.React.createElement("input",{type:"file",onChange:this.handleImageChange,className:"mt-2"}),e.React.createElement("div",{className:"form-coords mt-2"},"Lat: ",r.latitude," | Lon: ",r.longitude),e.React.createElement(t.Button,{onClick:this.handleSubmitForm,className:"mt-2"},"Submit")))}}componentDidMount(){this.makeDropdownDraggable()}componentDidUpdate(e,t){this.makeDropdownDraggable(),this.state.showLegend&&!t.showLegend&&this.loadLegend()}render(){const{incidentMode:r,alert:o,loading:n,showAlert:i,featureRecords:a,selectedFeatureId:s,searchText:c}=this.state;return e.React.createElement(e.DataSourceComponent,{useDataSource:this.props.useDataSources[0],onDataSourceCreated:this.onDsCreated},e.React.createElement("div",{className:"map-widget "+(r?"incident-mode":"")},e.React.createElement("div",{className:"map-container",ref:this.mapContainer}),e.React.createElement("div",{className:"locate-button"},e.React.createElement(t.Button,{onClick:this.zoomToUserLocation},"\u{1f4cd} Locate Me")),e.React.createElement("div",{style:{position:"absolute",top:180,left:20,zIndex:1e3}},e.React.createElement(t.Button,{onClick:this.handleLegendToggle},this.state.showLegend?"Hide Legend":"Show Legend")),this.state.showLegend&&e.React.createElement("div",{ref:this.LegendComponent,style:{position:"absolute",top:220,left:20,zIndex:999,backgroundColor:"white",padding:"10px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"}}),e.React.createElement(t.Button,{onClick:this.handleIncidentModeToggle,active:r,className:"incident-mode-btn"},r?"Cancel Incident Mode":"Create Incident"),e.React.createElement("div",{ref:this.dropdownRef,className:"dropdown-search-filter incident-card",style:{position:"absolute",top:20,right:20,zIndex:1e3,width:"300px"}},e.React.createElement("div",{className:"dropdown-drag-handle",style:{cursor:"move",fontWeight:"bold",marginBottom:"0.5rem"}},"\u{1f50d} Search Incidents"),e.React.createElement(t.TextInput,{type:"text",placeholder:"Search incidents...",className:"text-input",value:c,onChange:e=>this.filterIncidents(e.target.value)}),e.React.createElement("div",{className:"custom-dropdown mt-2"},e.React.createElement("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #ccc",borderRadius:"6px"}},a.map((t=>{const r=t.attributes.Title||`Incident #${t.attributes.OBJECTID}`,o=t.attributes.Description||"";return e.React.createElement("div",{key:t.attributes.OBJECTID,onClick:()=>{this.setState({selectedFeatureId:t.attributes.OBJECTID.toString()}),this.zoomToFeature(t.attributes.OBJECTID.toString())},style:{padding:"10px",borderBottom:"1px solid #eee",cursor:"pointer",backgroundColor:this.state.selectedFeatureId===t.attributes.OBJECTID.toString()?"#f0f0f0":"#fff"}},e.React.createElement("div",{style:{fontWeight:"bold"}},r),e.React.createElement("div",{style:{fontSize:"smaller",color:"#555"}},o))}))))),o&&i&&e.React.createElement(t.Alert,{withIcon:!0,type:"success",className:"m-2",closable:!0,onClose:()=>this.setState({showAlert:!1})},o),n&&e.React.createElement(t.Loading,{type:t.LoadingType.Secondary,text:"Submitting Incident..."}),r&&this.renderForm()))}}O.mapExtraStateProps=e=>({queryObject:e.queryObject});const j=O;function P(e){i.p=e}})(),a})())}}}));
